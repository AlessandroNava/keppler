<div class="chat">
    <header class="header" @click="onHeaderClick">
        Discussions ({{ unreadCount }})
    </header>
    <div class="content" v-show="open">
        <div class="messages" @scroll="onMessagesScroll">
            <div class="inner-messages">
                <div class="message" v-for="message of messages" :key="message.date">
                    <div class="date">
                        {{ message.time }}
                    </div>
                    <div class="user" :style="`color: ${message.user.color};`">
                        {{ message.user.name }}
                    </div>
                    <a href="#" class="file" v-if="message.file && message.line" @click.prevent="onFileClick(message.file, message.version, message.line)">
                        {{ message.file }}:{{ message.line }}
                    </a>
                    <div class="text" v-html="message.text.replace(/\n/g, '<br>')"></div>
                </div>
            </div>
        </div>
        <div class="infos" v-if="user">
            Your nickname is <input class="user-name" :style="`color: ${user.color};`" v-model="userName" @change="onUserNameChange($event)" @keydown="onUserNameKeyDown($event)"/>
        </div>
        <div class="question" v-if="question">
            Question:
            <span class="question-file">{{ question.file }}:{{ question.line }}</span>
            <a href="#" class="remove" @click.prevent="onQuestionRemoveClick">x</a>
        </div>
        <div class="message">
            <textarea class="textarea" v-model="messageText" @keydown="onMessageTextKeyDown($event)"></textarea>
        </div>
    </div>
</div>